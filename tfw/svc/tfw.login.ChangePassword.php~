<?php
$ROLE = "";


/**
 * Pour le détail des données stoquées sur disque et en session,
 * voir "sys.login.Challenge.php".
 *---------------------------------------------------------------
 * Ce service est appelé avec un nouveau mot de passe
 * pour l'utilisateur courant.
 */
function execService($newPassword, $SYS) {
  $SYS = $SYS->PRI;
  $SYS->setRoot("sys.Login");

  if (!isset($_SESSION["USER"])) return null;
  $user = $_SESSION["USER"];
  $login = $user["login"];

  $file = $login . ".json";
  $userDef = $SYS->loadJSON($file);
  $userDef["pwd"] = $newPassword;
  $SYS->saveJSON($file, $userDef);

  return true;
}
?>